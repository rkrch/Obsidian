Enchanced Interior Gateway Routing Protocol - Расширенный протокол маршрутизации  внутреннего шлюза. 

Роутер хранит 3 таблицы:
	Таблица со всеми текущими активными соседями
	Таблица с топологией сети (информация о маршрутах, полученная от соседей)
	Таблица маршрутизации

$(K_1*BW+(K_2*BW)/(256-LOAD)+K_3*Delay)*K_5/Reliability+K4))$
$BW=(10000/BW_{min})*256$
*где*
$Delay={Сумма-всех-задержек}*256$
	Обычно $K_1, K_3 = 1$ и $K_2, K_4, K_5 = 0$
	Metric = BW + Delay

Feasible Distance - метрика маршрута с точки зрения роутера

Advertised (Reported) Distance - метрика с точки зрения роутера, который рассказал об этом маршруте

Successor - маршрут с  лучшей метрикой
и Feasible Successor - запасной.

**EIGRP (Enhanced Interior Gateway Routing Protocol)** — это проприетарный протокол маршрутизации, разработанный компанией Cisco. Он является расширением более старого протокола IGRP (Interior Gateway Routing Protocol) и сочетает в себе лучшие качества как дистанционно-векторных, так и связных методов маршрутизации. EIGRP был разработан для улучшения быстродействия, масштабируемости и гибкости в больших и сложных сетях.

EIGRP работает на основе алгоритма DUAL (Diffusing Update Algorithm), который обеспечивает быстрый выбор оптимальных маршрутов и гарантирует отсутствие петель в сети.

Основные особенности EIGRP:

1. Тип протокола:    
* EIGRP — это гибридный протокол маршрутизации, который сочетает преимущества дистанционно-векторной и состояния соединения (link-state) маршрутизации.    

2. Алгоритм DUAL:    

- EIGRP использует алгоритм DUAL, который позволяет вычислять и поддерживать таблицы маршрутов, минимизируя задержки при изменении топологии сети.    
- Этот алгоритм помогает избежать петель маршрутизации, гарантируя, что выбранный маршрут всегда будет оптимальным.    

3. Метрика маршрутизации:    

- EIGRP использует комплексную метрику, основанную на четырёх параметрах:    

- Bandwidth (полоса пропускания) — пропускная способность канала.    
- Delay (задержка) — задержка при передаче данных через канал.    
- Load (нагрузка) — текущая нагрузка канала.    
- Reliability (надежность) — вероятность успешной передачи пакетов.    

- Обычно для вычисления метрики учитываются только полоса пропускания и задержка, но все четыре параметра могут быть настроены вручную.    

4. Раннее обнаружение изменений:    

- EIGRP использует обновления на основе событий, что означает, что маршрутизаторы отправляют информацию об изменениях маршрутов только тогда, когда топология сети изменяется (например, выход канала из строя), а не постоянно. Это помогает снизить нагрузку на сеть и повысить её эффективность.    

5. Поддержка нескольких протоколов:    

- EIGRP поддерживает маршрутизацию для различных типов протоколов, таких как IPv4, IPv6, а также для протоколов сетей CLNS (Connectionless Network Service) и IPX (Internetwork Packet Exchange).    

6. Время сходимости:    
- EIGRP обеспечивает быструю сходимость сети, что делает его подходящим для динамичных сред, где изменения топологии могут происходить часто.
    

7. Поддержка аутентификации:    

- EIGRP поддерживает механизмы аутентификации для обеспечения безопасности маршрутов. Это предотвращает возможность манипуляций с маршрутной информацией, что особенно важно в открытых или небезопасных сетях.    

Преимущества EIGRP:

- Быстрая сходимость: EIGRP может быстро адаптироваться к изменениям в сети, что минимизирует время простоя при отказах.    
- Гибкость метрик: Возможность настроить различные параметры для точной настройки маршрутизации.    
- Поддержка разных типов протоколов: EIGRP может работать не только с IP, но и с другими протоколами (например, IPX).    
- Легкость настройки: Благодаря автоматической настройке и минимальной нагрузке на процессор и сеть, EIGRP легко внедряется в сетях Cisco.    

Основные таблицы EIGRP:

1. Таблица маршрутизации:    

- В этой таблице хранится информация о лучших маршрутах к сети. Эти маршруты выбираются с использованием алгоритма DUAL.    

2. Таблица смежности:    

- В этой таблице хранятся маршрутизаторы, с которыми поддерживаются соседские отношения, а также информация о том, как EIGRP взаимодействует с ними.    

3. Таблица топологии:    

- В этой таблице содержится полная информация о всех возможных маршрутах (которые могут быть доступны в будущем), а не только о текущем оптимальном пути.


## Балансировка нагрузки в EIGRP

Балансировка нагрузки в EIGRP — это способность протокола маршрутизации распределять трафик между несколькими равноправными маршрутами к одному и тому же пункту назначения. Это позволяет эффективно использовать пропускную способность сети, улучшать отказоустойчивость и снизить нагрузку на отдельные маршруты.

EIGRP поддерживает неограниченную балансировку нагрузки, что означает, что трафик может быть распределен между многими маршрутами (до 16 равноправных маршрутов) для одного и того же назначения, в отличие от большинства других протоколов маршрутизации, которые поддерживают ограниченное количество маршрутов.

Принципы балансировки нагрузки в EIGRP:

1. Равноправные маршруты (Equal Cost Multi-Path, ECMP):    

- EIGRP позволяет балансировать нагрузку только между маршрутами, которые имеют одинаковую метрику (то есть равный стоимость маршрута).    
- Это достигается с помощью параметра метрики маршрута, который рассчитывается с учётом задержки, полосы пропускания, надежности и нагрузки.    
- Балансировка нагрузки между маршрутами с одинаковой метрикой называется равноправной балансировкой.    

2. Балансировка нагрузки между маршрутами с разной метрикой (Unequal Cost Multi-Path, UCMP):    
- EIGRP также поддерживает неравноправную балансировку нагрузки, где трафик может быть распределён между маршрутами с разной метрикой.    
- В отличие от ECMP, при UCMP маршрутизатор может использовать маршрут с более высокой метрикой, если это позволяет конфигурация и политика.    

3. Количество маршрутов для балансировки:    
- По умолчанию EIGRP позволяет балансировать нагрузку между до 4 маршрутами, но это число можно увеличить до 16 маршрутов.    
- Параметр maximum-paths используется для указания максимального количества маршрутов, которые могут быть использованы для балансировки нагрузки.    

Механизм работы балансировки нагрузки:

- Метрики маршрутов: EIGRP использует свою метрику для вычисления наилучших путей. Балансировка нагрузки возможна только между маршрутами с одинаковой метрикой, либо с метриками, которые попадают в допустимый диапазон, заданный variance.    
- Применение алгоритма DUAL: Алгоритм DUAL (Diffusing Update Algorithm) вычисляет и поддерживает таблицы маршрутов, выбирая несколько равноправных маршрутов для одного назначения, если такие маршруты существуют.    

Пример работы с балансировкой нагрузки:

Предположим, что у нас есть несколько маршрутов с одинаковой метрикой и мы хотим использовать их для балансировки нагрузки. Если у нас настроены маршруты с метрикой 1000 и максимальное количество путей равно 4, EIGRP будет равномерно распределять трафик между этими четырьмя маршрутами. Если включена variance, маршруты с более высокой метрикой могут быть добавлены в список равноправных маршрутов, если их стоимость не превышает в два раза стоимости лучшего маршрута.