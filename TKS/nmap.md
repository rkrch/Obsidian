network mapper
утилита для обнаружения хостов и информации о них

[[wireshark]] - позволяет перехватывать сетевые пакеты

## Флаги

### `-sS` - флаг по умолчанию при `sudo nmap` 
больше 4 уровня [[OSI]] инфы не даёт
`sudo nmap -sS ip` сканит по [[IP]], показывает [[MAC]] и порты 
_syn -> syn ack -> rst_

`sudo nmap -sS ip --reason` - показывает прчину по которой считает открытым порт. напр. syn ack

### `-sT`  - флаг по умолчанию при `nmap`
`sudo nmap -sS ip`
_syn -> syn ack -> ack, rst_

### `-sn` 
`sudo nmap -sn ***.***.**.0/24` - сканит сеть
ARP запросы в своей сети, для MACа
в другой сети, например за vpn пингует
### `-sN`
`sudo nmap -sN ip` - _null_ скан (пустой, без флага)
распр. вид скана, если банят по _syn_
`--reason` например по закрытому порту ответ rst, ack, а по открытому ответа не получил

### `-sV`
`sudo nmap -sV ip -v`
Показывает тип сервиса на порту и его версию

### `-sC`
`sudo nmap -sC ip` прогоняет `default` скрипты

### `-sC -sV -v`
синергируют, когда -sV понимает что перед ним, -sC пробует забрать нужную инфу
`-v` - verbosity ещё в процессе скана показывает открытые порты

### `-sA`
`sudo nmap -sA ip` aggressive (не стоит, самый шумный)
Ищет фильтры (firewall)
индентичен -sC -sV -O (версия ос)--traceroute

### `-sF`
`sudo nmap -sF ip` FIN скан.
если ответ RST,ACK то закрыт, если FIN то открыт
если нет ответа - открыт/фильтр

### `-sX`
`sudo nmap -sX ip` Xmas скан
Шлёт FIN, PSH, URG
ответ как у `-sF`

### `-Pn`
Подразумевает что каждая машина потенциально может быть включена и на каждый адрес сети будет слать tcp пакеты вместо пинга
`sudo nmap ip ip -Pn`
`sudo nmap 10.10.10.3-6 - Pn`

### `-p`
Задаёт порты 
`sudo nmap 10.10.10.3 -p21-100`
`-p- - все 65к портов`

### `-oA` или `-oX`
будет записывать в файлы
X - только xml документ
`sudo nmap ip -Pn -X scan`
`xsltpoc scan -o scan.html`

### `--source-port`
задаёт порт источник  
