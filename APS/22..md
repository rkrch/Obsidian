28. Процессоры общего назначения и методы повышения их производительности на примере реализации современной архитектуры x86 от

Intel.

**(****Лекция 22. Системы общего назначения****)** Классификация микропроцессоров:

![](file:///C:/Users/kravr/AppData/Local/Temp/msohtmlclip1/01/clip_image002.jpg)

Микропроцессоры **общего назначения** – нужны для решения любых задач, они не предназначены для специализированных задач. Для них мы используем специализированные микропроцессоры.

Процессоры архитектуры **x86** имеют архитектуру с полным набором команд (CISC), то есть поддерживают большое количество инструкций с разной шириной.

Впервые архитектура x86 была представлена компанией Intel в 1978 году (Intel 8086). Следующие версии 8086 стали совершенствовать первую версию добавлением новых инструкций, таймеров, контроллеров, защищенных режимов и т.д. Полный список представлен в таблице.

![](file:///C:/Users/kravr/AppData/Local/Temp/msohtmlclip1/01/clip_image004.jpg)

Когда Intel делают свои процессоры они используют подход "**Тик-так**". Суть его заключается в том, что они в одном году разрабатывают новую архитектуру (тик), а в следующем осваивают новый тех. процесс (так). ("Тик-так" работал до 2015 года.)

Рассмотрим микроархитектуру процессора **Coffee Lake**, выпущенного в 2017-ом году. Она состоит из трех основных блоков:

●       **Memory Subsystem** (подсистема памяти);

●       **Execution Engine** (RISC-ядра);

●       **Front-end** (CISC-оболочка поверх **Execution Engine**, грубо говоря, CISC инструкции декодируются в RISC инструкции и передаются в **Execution Engine**).

![](file:///C:/Users/kravr/AppData/Local/Temp/msohtmlclip1/01/clip_image006.jpg)

Какие применяются **методы повышения производительности**:

1.      Увеличение тактовой частоты процессора.

2.      Использование многоядерных процессоров (Многоядерность). Coffee Lake может иметь 4, 6 и 8 ядер. Подсистемы памяти каждого ядра объединяются в кольцевую шину. **Кольцевая шина** передаёт информацию по кругу, благодаря чему устраняются конфликты, допустим, когда несколько устройств хотят завладеть шиной. (Метод кольцевой шины имеет и минусы – если её расширять, то её пропускная способность падает.) В правой части находится **System Agent**. Он связан с взаимодействием с памятью, дисплеем и другими внешними устройствами. В правой части графическое ядро **Gen9.5**.

![](file:///C:/Users/kravr/AppData/Local/Temp/msohtmlclip1/01/clip_image008.gif)

3.      Улучшение кэширования. Многоуровневый кэш, отдельные кэши для инструкций, и для данных, и общий кэш. Увеличение объема кэш-памяти на процессоре, а также улучшение алгоритмов управления кешем для более эффективного использования.

4.      Оптимизация потока инструкций. Например в Coffee Lake есть блок **Macro-Fusion**. Из блока **Буфера предварительного кодирования** выходят до 6 макро-операций, которые затем подаются в блок очереди инструкций, где (в некоторых случаях) благодаря **Macro-Fusion** две последовательно идущие инструкции могут быть преобразованы в одну. За такт может произойти только одно подобное объединение. Иными словами, даже если в очереди окажется две пары подходящих для объединения инструкций, объединена будет только первая пара (кроме того, есть и другие ограничения по объединению). Почему этап Macro-Fusion не может быть реализован на этапе компиляции программы? Дело в том, что в результате этого преобразования, результирующая макро-операция уже не является какой-то стандартной x86-инструкцией. Вместо этого, она становится какой-то специальной инструкцией, которая в дальнейшем может быть декодирована и исполнена только данной микроархитектурой процессора.

5.      Предсказатель результата ветвлений (**Branch Predictor**) говорит о том какой адрес необходимо использовать для получения новых инструкций еще до вычисления результата ветвления.

6.      Буфер декодированного потока инструкций (**Decoded Stream Buffer**) содержит декодированные ранее операции. В случае, если будут получены макро-операции, которые уже были недавно декодированы, данный буфер сможет сразу же выдать готовые микро-инструкции.

7.      **Loop Stream Detector** необходим для запоминания последних 18 (в Coffee Lake) инструкций и определяет есть ли цикл.

8.      (AI) Использование технологий предварительного выполнения инструкций (out-of-order execution) и предварительной загрузки данных (prefetching) для оптимизации процесса выполнения команд.

(AI) Все эти методы направлены на создание более эффективной микроархитектуры процессора, которая способна обеспечить более быстрое выполнение инструкций и обработку данных.